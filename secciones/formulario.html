<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Formulario de Pedido Jafra</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- BOOTSTRAP 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- ICONOS BOOTSTRAP -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

  <style>
    body{
      background: linear-gradient(135deg,#bbd6f8,#e1bee7);
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:center;
      overflow:hidden;
      position:relative;
    }

    /* Burbujas flotantes del fondo */
    .bubble{
      position:absolute;
      width:70px;
      height:70px;
      background:rgba(255,255,255,0.35);
      border-radius:50%;
      filter:blur(3px);
      animation: float 9s infinite ease-in-out;
    }

    .bubble:nth-child(1){ left:10%; animation-duration:12s; }
    .bubble:nth-child(2){ left:60%; animation-duration:9s; }
    .bubble:nth-child(3){ left:35%; animation-duration:14s; }
    .bubble:nth-child(4){ left:80%; animation-duration:11s; }

    @keyframes float {
      0% { transform: translateY(100vh) scale(1); opacity:0.5; }
      50% { opacity:0.7; }
      100% { transform: translateY(-10vh) scale(1.2); opacity:0.5; }
    }

    /* Tarjeta Glass */
    .card{
      background: rgba(255,255,255,0.35);
      backdrop-filter: blur(15px);
      border-radius:25px;
      border:1px solid rgba(255,255,255,0.4);
      box-shadow:0 15px 40px rgba(0,0,0,0.15);
      animation: fadeIn 1.2s ease;
    }

    @keyframes fadeIn{
      from { opacity:0; transform:translateY(20px); }
      to   { opacity:1; transform:translateY(0); }
    }

    h2{
      color:#b89957;
      font-weight:800;
      text-transform:uppercase;
      letter-spacing:2px;
      position:relative;
    }

    h2::after{
      content:"";
      width:60px;
      height:4px;
      background:#b89957;
      border-radius:5px;
      position:absolute;
      bottom:-10px;
      left:50%;
      transform:translateX(-50%);
    }

    .form-control{
      border-radius:15px;
      padding:12px;
      border:1px solid #d0c4d6;
      box-shadow: inset 0 0 0 rgba(0,0,0,0);
      transition:0.25s;
    }

    .form-control:focus{
      border-color:#b89957;
      box-shadow:0 0 12px rgba(184,153,87,0.4);
    }

    .btn-jafra{
      background:#b89957;
      color:white;
      font-weight:bold;
      padding:12px;
      border-radius:25px;
      transition:0.3s;
      font-size:18px;
    }

    .btn-jafra:hover{
      background:#937640;
      transform:scale(1.05);
      color:white;
    }

    /* ================= NOTIFICACIÃ“N WHATSAPP ================= */
    #notiWhatsApp{
      position:fixed;
      top:-120px;
      right:20px;
      background:#fff;
      display:flex;
      align-items:center;
      gap:12px;
      padding:15px 20px;
      border-radius:15px;
      box-shadow:0 5px 15px rgba(0,0,0,0.2);
      transition:0.5s;
      z-index:9999;
      max-width:300px;
    }
  </style>
</head>
<body>

<!-- Fondo animado -->
<div class="bubble"></div>
<div class="bubble"></div>
<div class="bubble"></div>
<div class="bubble"></div>

<!-- ðŸ”” NOTIFICACIÃ“N ESTILO WHATSAPP -->
<div id="notiWhatsApp">
  <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" width="45">
  <div>
    <strong style="color:#25D366">WhatsApp</strong>
    <p>ðŸ‘‹ Nuevo mensaje: Pedido enviado correctamente</p>
  </div>
</div>

<div class="container" style="max-width: 650px;">
  <div class="card p-4 shadow-lg">
    <form id="formPedido">
      <h2 class="text-center mb-4">Pedido Jafra</h2>

      <div class="mb-3">
        <label class="form-label"><i class="bi bi-person-fill"></i> Nombre completo</label>
        <input type="text" id="nombre" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label"><i class="bi bi-envelope-fill"></i> Correo electrÃ³nico</label>
        <input type="email" id="email" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label"><i class="bi bi-telephone-fill"></i> TelÃ©fono</label>
        <input type="number" id="telefono" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label"><i class="bi bi-chat-left-dots-fill"></i> Asunto</label>
        <input type="text" id="asunto" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label"><i class="bi bi-pencil-fill"></i> Mensaje</label>
        <textarea id="mensaje" rows="4" class="form-control" required></textarea>
      </div>

      <button id="btnNotificar" class="btn btn-jafra w-100">
        <i class="bi bi-send-fill"></i> Enviar Pedido
      </button>
    </form>
  </div>
</div>

<script>
// Registrar Service Worker
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('../sw.js')
  .then(() => console.log("SW registrado correctamente"))
  .catch(err => console.log("Error SW:", err));
}

// BOTÃ“N
document.getElementById("btnNotificar").addEventListener("click", async (e) => {
  e.preventDefault();

  // CAPTURAR DATOS DEL FORMULARIO
  const nombre = document.getElementById("nombre").value.trim();
  const email = document.getElementById("email").value.trim();
  const telefono = document.getElementById("telefono").value.trim();
  const asunto = document.getElementById("asunto").value.trim();
  const mensaje = document.getElementById("mensaje").value.trim();

  if(!nombre || !email || !telefono || !asunto || !mensaje){
    alert("Por favor llena todos los campos.");
    return;
  }

  // ARMAR MENSAJE WHATSAPP
  let mensajeWhats = 
`ðŸ“¦ *NUEVO PEDIDO JAFRA*

ðŸ‘¤ *Nombre:* ${nombre}
ðŸ“§ *Correo:* ${email}
ðŸ“± *TelÃ©fono:* ${telefono}
ðŸ“ *Asunto:* ${asunto}

ðŸ’¬ *Mensaje:*
${mensaje}

Enviado desde el formulario Jafra.`;

  // ENCODE PARA URL
  mensajeWhats = encodeURIComponent(mensajeWhats);

  const permiso = await Notification.requestPermission();
  if (permiso !== "granted") {
    alert("Debes permitir notificaciones");
    return;
  }

  const sw = await navigator.serviceWorker.ready;
  sw.active.postMessage("mostrarNotificacion");

  // REDIRIGIR A WHATSAPP CON MENSAJE
  setTimeout(() => {
    window.location.href = `https://wa.me/522751203903?text=${mensajeWhats}`;
  }, 2500);

});
</script>


</body>
</html>
